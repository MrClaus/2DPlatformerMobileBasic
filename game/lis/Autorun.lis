0 WSCREEN%=SCREENWIDTH(0):HSCREEN%=SCREENHEIGHT(0):DELTAWS%=WSCREEN%-352:DELTAHS%=HSCREEN%-416:WSW=0:HSH=0
1 IF DELTAWS%>0 THEN WSW=1: GELGRAB "wscreenw",352,0,DELTAWS%,HSCREEN%
2 IF DELTAHS%>0 THEN HSH=1: GELGRAB "hscreenh",0,416,352,DELTAHS%
3 REM "-----------------------GEL LOAD--------------------->>>>>"
4 GELLOAD "fon","map.png"
5 SETCOLOR 255,0,0: FILLRECT 0,0,352,416: GELGRAB "hearthp1",0,0,352,416: GELGRAB "hearthp2",0,0,352,416: ALPHAGEL "hearthp1",32: ALPHAGEL "hearthp2",64
6 GELLOAD "info1","info1.png": GELLOAD "info2","info2.png"
10 FOR T%=1 TO 8
11 NAME1$="ppk"+STR$(9-T%):NAME2$="apk"+STR$(T%):NAME1S$="pk"+STR$(T%)+".png":NAME2S$="pk"+STR$(T%)+".png": GELLOAD NAME1$,NAME1S$: GELLOAD NAME2$,NAME2S$
12 NEXT T%
13 GELLOAD "npk1","pk1.png"
17 GELLOAD "r1","r1.png": GELLOAD "r2","r2.png": GELLOAD "r3","r3.png": GELLOAD "r4","r4.png": GELLOAD "r5","r5.png": GELLOAD "r6","r6.png"
18 GELLOAD "l1","l1.png": GELLOAD "l2","l2.png": GELLOAD "l3","l3.png": GELLOAD "l4","l4.png": GELLOAD "l5","l5.png": GELLOAD "l6","l6.png"
19 GELLOAD "upl1","upl.png": GELLOAD "upr1","upr.png"
20 GELLOAD "sr1","sr1.png": GELLOAD "sr2","sr2.png": GELLOAD "sl1","sl1.png": GELLOAD "sl2","sl2.png": GELLOAD "shar1","shar1.png"
21 GELLOAD "shar2","shar2.png": GELLOAD "shar3","shar3.png": GELLOAD "shar4","shar4.png": GELLOAD "shar5","shar5.png"
22 GELLOAD "brona1","brona1.png": GELLOAD "brona2","brona2.png": GELLOAD "play","play.png"
23 GELLOAD "lfg1","lfg1.png": GELLOAD "lfg2","lfg2.png": GELLOAD "lfv1","lfv1.png": GELLOAD "lfv2","lfv2.png"
24 GELLOAD "lh","loadh.png": GELLOAD "loadh","loadh.png": GELLOAD "le","loade.png": GELLOAD "loade","loade.png"
25 GELLOAD "endblood","endblood.png": GELLOAD "camera","camera.png": GELLOAD "gokey","gokey.png"
26 FOR T%=1 TO 5
27 NAME1$="rpdrag"+STR$(T%):NAME1S$=NAME1$+".png":NAME2$="lpdrag"+STR$(T%):NAME2S$=NAME2$+".png": GELLOAD NAME1$,NAME1S$: GELLOAD NAME2$,NAME2S$
28 NEXT T%
29 FOR T%=1 TO 5
30 NAME1$="radrag"+STR$(T%):NAME1S$="rpdrag"+STR$(T%)+".png":NAME2$="ladrag"+STR$(T%):NAME2S$="lpdrag"+STR$(T%)+".png": GELLOAD NAME1$,NAME1S$: GELLOAD NAME2$,NAME2S$
31 NEXT T%
32 FOR T%=1 TO 10
33 NAME1$="lav"+STR$(T%):NAME2$=NAME1$+".png": GELLOAD NAME1$,NAME2$
34 NEXT T%
35 FOR T%=1 TO 5
36 NAME1$="ph"+STR$(6-T%):NAME2$="ah"+STR$(T%):NAME1S$="h"+STR$(T%)+".png":NAME2S$="h"+STR$(T%)+".png": GELLOAD NAME1$,NAME1S$: GELLOAD NAME2$,NAME2S$
37 NEXT T%
38 GELLOAD "nh1","h1.png"
39 GELLOAD "leftset1","leftset1.png": GELLOAD "leftset2","leftset2.png": GELLOAD "set1","set1.png": GELLOAD "set2","set2.png": GELLOAD "txtset","txtset.png"
40 GELLOAD "leftra1","leftra1.png": GELLOAD "leftra2","leftra2.png": GELLOAD "ra1","ra1.png": GELLOAD "ra2","ra2.png": GELLOAD "txtra","txtra.png"
41 GELLOAD "leftgor1","leftgor1.png": GELLOAD "leftgor2","leftgor2.png": GELLOAD "gor1","gor1.png": GELLOAD "gor2","gor2.png": GELLOAD "txtgor","txtgor.png"
42 GELLOAD "lefttor1","lefttor1.png": GELLOAD "lefttor2","lefttor2.png": GELLOAD "tor1","tor1.png": GELLOAD "tor2","tor2.png": GELLOAD "txttor","txttor.png"
43 GELLOAD "krov1","krov1.png": GELLOAD "krov2","krov2.png": GELLOAD "txtkrov","txtkrov.png": GELLOAD "pist1","pist1.png": GELLOAD "pist2","pist2.png": GELLOAD "txtpist","txtpist.png"
44 GELLOAD "tk1","tk1.png": GELLOAD "tk2","tk2.png": GELLOAD "txttk","txttk.png": GELLOAD "zap1","zap1.png": GELLOAD "zap2","zap2.png": GELLOAD "txtzap","txtzap.png"
45 GELLOAD "sim1","sim1.png": GELLOAD "sim2","sim2.png": GELLOAD "txtsim","txtsim.png"
46 GELLOAD "lsens1","leftsensor1.png": GELLOAD "lsens2","leftsensor2.png": GELLOAD "rsens1","rightsensor1.png": GELLOAD "rsens2","rightsensor2.png"
47 GELLOAD "fsens1","firesensor1.png": GELLOAD "fsens2","firesensor2.png": GELLOAD "usens1","upsensor1.png": GELLOAD "usens2","upsensor2.png"
48 GELLOAD "timers","chas.png"
100 REM "0--------------TYPE - MONSTER AKTIV--------------->>>>>"
101 MA%=7
102 DIM XMA(MA%): DIM YMA(MA%): DIM WMA(MA%): DIM HMA(MA%): DIM XPOSMA(MA%): DIM YPOSMA(MA%): DIM NAMEA$(MA%): DIM STATUSA%(MA%): DIM XSTMA(MA%): DIM YSTMA(MA%): DIM ANIMA%(MA%): DIM ZNAK(MA%)
103 DIM A_NGRAFM%(MA%): DIM A_TIMEANIM%(MA%): DIM A_DELTAM%(MA%): DIM A_SPEEDM%(MA%): DIM A_TIME%(MA%): DIM P_NGRAFM%(MA%): DIM P_TIMEANIM%(MA%): DIM P_DELTAM%(MA%): DIM P_SPEEDM%(MA%): DIM P_TIME%(MA%)
104 REM "---1----------------------------------------------"
105 XMA(0)=425:YMA(0)=210:WMA(0)=34:HMA(0)=56:XSTMA(0)=425:YSTMA(0)=210:XPOSMA(0)=625:YPOSMA(0)=210:NAMEA$(0)="drag":STATUSA%(0)=-1
106 A_NGRAFM%(0)=5:A_TIMEANIM%(0)=50:A_DELTAM%(0)=80:A_SPEEDM%(0)=2.71:A_TIME%(0)= MILLISECONDS (0)
107 P_NGRAFM%(0)=5:P_TIMEANIM%(0)=100:P_DELTAM%(0)=40:P_SPEEDM%(0)=1.62:P_TIME%(0)= MILLISECONDS (0)
108 REM "---2----------------------------------------------"
109 XMA(1)=370:YMA(1)=450:WMA(1)=34:HMA(1)=56:XSTMA(1)=370:YSTMA(1)=450:XPOSMA(1)=460:YPOSMA(1)=450:NAMEA$(1)="drag":STATUSA%(1)=-1
110 A_NGRAFM%(1)=5:A_TIMEANIM%(1)=50:A_DELTAM%(1)=50:A_SPEEDM%(1)=2.71:A_TIME%(1)= MILLISECONDS (0)
111 P_NGRAFM%(1)=5:P_TIMEANIM%(1)=100:P_DELTAM%(1)=25:P_SPEEDM%(1)=1.62:P_TIME%(1)= MILLISECONDS (0)
112 REM "---3----------------------------------------------"
113 XMA(2)=695:YMA(2)=610:WMA(2)=34:HMA(2)=56:XSTMA(2)=695:YSTMA(2)=610:XPOSMA(2)=815:YPOSMA(2)=610:NAMEA$(2)="drag":STATUSA%(2)=-1
114 A_NGRAFM%(2)=5:A_TIMEANIM%(2)=50:A_DELTAM%(2)=2:A_SPEEDM%(2)=2.71:A_TIME%(2)= MILLISECONDS (0)
115 P_NGRAFM%(2)=5:P_TIMEANIM%(2)=100:P_DELTAM%(2)=1:P_SPEEDM%(2)=1.62:P_TIME%(2)= MILLISECONDS (0)
116 REM "---4----------------------------------------------"
117 XMA(3)=1115:YMA(3)=450:WMA(3)=34:HMA(3)=56:XSTMA(3)=1115:YSTMA(3)=450:XPOSMA(3)=1160:YPOSMA(3)=450:NAMEA$(3)="drag":STATUSA%(3)=-1
118 A_NGRAFM%(3)=5:A_TIMEANIM%(3)=50:A_DELTAM%(3)=60:A_SPEEDM%(3)=2.71:A_TIME%(3)= MILLISECONDS (0)
119 P_NGRAFM%(3)=5:P_TIMEANIM%(3)=100:P_DELTAM%(3)=30:P_SPEEDM%(3)=1.62:P_TIME%(3)= MILLISECONDS (0)
120 REM "---5----------------------------------------------"
121 XMA(4)=1400:YMA(4)=210:WMA(4)=34:HMA(4)=56:XSTMA(4)=1400:YSTMA(4)=210:XPOSMA(4)=1460:YPOSMA(4)=210:NAMEA$(4)="drag":STATUSA%(4)=-1
122 A_NGRAFM%(4)=5:A_TIMEANIM%(4)=50:A_DELTAM%(4)=2:A_SPEEDM%(4)=2.71:A_TIME%(4)= MILLISECONDS (0)
123 P_NGRAFM%(4)=5:P_TIMEANIM%(4)=100:P_DELTAM%(4)=1:P_SPEEDM%(4)=1.62:P_TIME%(4)= MILLISECONDS (0)
124 REM "---6----------------------------------------------"
125 XMA(5)=1610:YMA(5)=450:WMA(5)=34:HMA(5)=56:XSTMA(5)=1610:YSTMA(5)=450:XPOSMA(5)=1700:YPOSMA(5)=450:NAMEA$(5)="drag":STATUSA%(5)=-1
126 A_NGRAFM%(5)=5:A_TIMEANIM%(5)=50:A_DELTAM%(5)=70:A_SPEEDM%(5)=2.71:A_TIME%(5)= MILLISECONDS (0)
127 P_NGRAFM%(5)=5:P_TIMEANIM%(5)=100:P_DELTAM%(5)=35:P_SPEEDM%(5)=1.62:P_TIME%(5)= MILLISECONDS (0)
128 REM "---7----------------------------------------------"
129 XMA(6)=1855:YMA(6)=210:WMA(6)=34:HMA(6)=56:XSTMA(6)=1855:YSTMA(6)=210:XPOSMA(6)=1940:YPOSMA(6)=210:NAMEA$(6)="drag":STATUSA%(6)=-1
130 A_NGRAFM%(6)=5:A_TIMEANIM%(6)=50:A_DELTAM%(6)=50:A_SPEEDM%(6)=2.71:A_TIME%(6)= MILLISECONDS (0)
131 P_NGRAFM%(6)=5:P_TIMEANIM%(6)=100:P_DELTAM%(6)=25:P_SPEEDM%(6)=1.62:P_TIME%(6)= MILLISECONDS (0)
200 REM "---------------TYPE - MONSTER PASSIV-------------->>>>>"
201 MP%=11
202 DIM XMP(MP%): DIM YMP(MP%): DIM WMP(MP%): DIM HMP(MP%): DIM NAMEP$(MP%): DIM STATUSP%(MP%): DIM TIME_AP%(MP%): DIM ANIMP%(MP%): DIM DELTA_MP%(MP%): DIM ZONA%(MP%): DIM TIMES_MP%(MP%)
203 DIM PNGRAF_A%(MP%): DIM PTIME_A%(MP%): DIM PNGRAF_P%(MP%): DIM PTIME_P%(MP%): DIM PNGRAF_N%(MP%): DIM PTIME_N%(MP%): DIM MP_ATIME%(MP%): DIM MP_PTIME%(MP%): DIM MP_NTIME%(MP%)
204 REM "---1----------------------------------------------"
205 XMP(0)=360:YMP(0)=288:WMP(0)=21:HMP(0)=50:NAMEP$(0)="pk":STATUSP%(0)=0:TIME_AP%(0)=2000:DELTA_MP%(0)=30:TIMES_MP%(0)= MILLISECONDS (0)
206 PNGRAF_A%(0)=8:PTIME_A%(0)=81:MP_ATIME%= MILLISECONDS (0)
207 PNGRAF_P%(0)=8:PTIME_P%(0)=81:MP_PTIME%= MILLISECONDS (0)
208 PNGRAF_N%(0)=1:PTIME_N%(0)=0:MP_NTIME%= MILLISECONDS (0)
209 REM "---2----------------------------------------------"
210 XMP(1)=644:YMP(1)=528:WMP(1)=21:HMP(1)=50:NAMEP$(1)="pk":STATUSP%(1)=0:TIME_AP%(1)=2000:DELTA_MP%(1)=30:TIMES_MP%(1)= MILLISECONDS (0)
211 PNGRAF_A%(1)=8:PTIME_A%(1)=81:MP_ATIME%= MILLISECONDS (0)
212 PNGRAF_P%(1)=8:PTIME_P%(1)=81:MP_PTIME%= MILLISECONDS (0)
213 PNGRAF_N%(1)=1:PTIME_N%(1)=0:MP_NTIME%= MILLISECONDS (0)
214 REM "---3----------------------------------------------"
215 XMP(2)=737:YMP(2)=528:WMP(2)=21:HMP(2)=50:NAMEP$(2)="pk":STATUSP%(2)=0:TIME_AP%(2)=2000:DELTA_MP%(2)=30:TIMES_MP%(2)= MILLISECONDS (0)
216 PNGRAF_A%(2)=8:PTIME_A%(2)=81:MP_ATIME%= MILLISECONDS (0)
217 PNGRAF_P%(2)=8:PTIME_P%(2)=81:MP_PTIME%= MILLISECONDS (0)
218 PNGRAF_N%(2)=1:PTIME_N%(2)=0:MP_NTIME%= MILLISECONDS (0)
219 REM "---4----------------------------------------------"
220 XMP(3)=1084:YMP(3)=368:WMP(3)=21:HMP(3)=50:NAMEP$(3)="pk":STATUSP%(3)=0:TIME_AP%(3)=2000:DELTA_MP%(3)=30:TIMES_MP%(3)= MILLISECONDS (0)
221 PNGRAF_A%(3)=8:PTIME_A%(3)=81:MP_ATIME%= MILLISECONDS (0)
222 PNGRAF_P%(3)=8:PTIME_P%(3)=81:MP_PTIME%= MILLISECONDS (0)
223 PNGRAF_N%(3)=1:PTIME_N%(3)=0:MP_NTIME%= MILLISECONDS (0)
224 REM "---5----------------------------------------------"
225 XMP(4)=1570:YMP(4)=368:WMP(4)=21:HMP(4)=50:NAMEP$(4)="pk":STATUSP%(4)=0:TIME_AP%(4)=2000:DELTA_MP%(4)=30:TIMES_MP%(4)= MILLISECONDS (0)
226 PNGRAF_A%(4)=8:PTIME_A%(4)=81:MP_ATIME%= MILLISECONDS (0)
227 PNGRAF_P%(4)=8:PTIME_P%(4)=81:MP_PTIME%= MILLISECONDS (0)
228 PNGRAF_N%(4)=1:PTIME_N%(4)=0:MP_NTIME%= MILLISECONDS (0)
229 REM "---6----------------------------------------------"
230 XMP(5)=1815:YMP(5)=448:WMP(5)=21:HMP(5)=50:NAMEP$(5)="pk":STATUSP%(5)=0:TIME_AP%(5)=2000:DELTA_MP%(5)=30:TIMES_MP%(5)= MILLISECONDS (0)
231 PNGRAF_A%(5)=8:PTIME_A%(5)=81:MP_ATIME%= MILLISECONDS (0)
232 PNGRAF_P%(5)=8:PTIME_P%(5)=81:MP_PTIME%= MILLISECONDS (0)
233 PNGRAF_N%(5)=1:PTIME_N%(5)=0:MP_NTIME%= MILLISECONDS (0)
234 REM "---7----------------------------------------------"
235 XMP(6)=587:YMP(6)=630:WMP(6)=20:HMP(6)=40:NAMEP$(6)="h":STATUSP%(6)=0:TIME_AP%(6)=2000:DELTA_MP%(6)=30:TIMES_MP%(6)= MILLISECONDS (0)
236 PNGRAF_A%(6)=5:PTIME_A%(6)=81:MP_ATIME%= MILLISECONDS (0)
237 PNGRAF_P%(6)=5:PTIME_P%(6)=81:MP_PTIME%= MILLISECONDS (0)
238 PNGRAF_N%(6)=1:PTIME_N%(6)=0:MP_NTIME%= MILLISECONDS (0)
239 REM "---8----------------------------------------------"
240 XMP(7)=853:YMP(7)=310:WMP(7)=20:HMP(7)=40:NAMEP$(7)="h":STATUSP%(7)=0:TIME_AP%(7)=2000:DELTA_MP%(7)=30:TIMES_MP%(7)= MILLISECONDS (0)
241 PNGRAF_A%(7)=5:PTIME_A%(7)=81:MP_ATIME%= MILLISECONDS (0)
242 PNGRAF_P%(7)=5:PTIME_P%(7)=81:MP_PTIME%= MILLISECONDS (0)
243 PNGRAF_N%(7)=1:PTIME_N%(7)=0:MP_NTIME%= MILLISECONDS (0)
244 REM "---9----------------------------------------------"
245 XMP(8)=1077:YMP(8)=550:WMP(8)=20:HMP(8)=40:NAMEP$(8)="h":STATUSP%(8)=0:TIME_AP%(8)=2000:DELTA_MP%(8)=30:TIMES_MP%(8)= MILLISECONDS (0)
246 PNGRAF_A%(8)=5:PTIME_A%(8)=81:MP_ATIME%= MILLISECONDS (0)
247 PNGRAF_P%(8)=5:PTIME_P%(8)=81:MP_PTIME%= MILLISECONDS (0)
248 PNGRAF_N%(8)=1:PTIME_N%(8)=0:MP_NTIME%= MILLISECONDS (0)
249 REM "---10---------------------------------------------"
250 XMP(9)=1552:YMP(9)=550:WMP(9)=20:HMP(9)=40:NAMEP$(9)="h":STATUSP%(9)=0:TIME_AP%(9)=2000:DELTA_MP%(9)=30:TIMES_MP%(9)= MILLISECONDS (0)
251 PNGRAF_A%(9)=5:PTIME_A%(9)=81:MP_ATIME%= MILLISECONDS (0)
252 PNGRAF_P%(9)=5:PTIME_P%(9)=81:MP_PTIME%= MILLISECONDS (0)
253 PNGRAF_N%(9)=1:PTIME_N%(9)=0:MP_NTIME%= MILLISECONDS (0)
254 REM "---11---------------------------------------------"
255 XMP(10)=1647:YMP(10)=390:WMP(10)=20:HMP(10)=40:NAMEP$(10)="h":STATUSP%(10)=0:TIME_AP%(10)=2000:DELTA_MP%(10)=30:TIMES_MP%(10)= MILLISECONDS (0)
256 PNGRAF_A%(10)=5:PTIME_A%(10)=81:MP_ATIME%= MILLISECONDS (0)
257 PNGRAF_P%(10)=5:PTIME_P%(10)=81:MP_PTIME%= MILLISECONDS (0)
258 PNGRAF_N%(10)=1:PTIME_N%(10)=0:MP_NTIME%= MILLISECONDS (0)
300 REM "---------------TYPE - OBJECTS MAP----------------->>>>>"
301 OBJ%=43
302 DIM XOBJ(OBJ%): DIM YOBJ(OBJ%): DIM WOBJ(OBJ%): DIM HOBJ(OBJ%): DIM GRAF_ANIM%(OBJ%): DIM SLEEP_OBJ%(OBJ%): DIM NAME_OBJ$(OBJ%): DIM INFO_OBJ%(OBJ%): DIM ULIK_OBJ%(OBJ%)
303 DIM COLLISION_OBJ%(OBJ%): DIM S_OBJ%(OBJ%): DIM STATUS_INFO%(OBJ%): DIM BU%(OBJ%): DIM TIME_OBJ%(OBJ%): DIM ANIM_OBJ%(OBJ%): DIM TAKEN%(OBJ%): DIM HELL%(OBJ%): DIM LEFT_TO_PERSONA%(OBJ%): DIM LEFT_TO%(OBJ%)
304 REM "---TXT - INFO PARAMETRS---------------------------"
305 XTXTINF=0:YTXTINF=58:SLEEP_STATUS%=500
306 REM "---ICON - INFO PARAMETRS--------------------------"
307 WINFO=9:HINFO=13:INFO_ICON$="info":GRAFANIM_INFO%=2:SLEEP_INFO%=444
308 REM "---1----------------------------------------------"
309 XOBJ(0)=177:YOBJ(0)=588:WOBJ(0)=220:HOBJ(0)=20:GRAF_ANIM%(0)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(0)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(0)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
310 XOBJ(1)=143:YOBJ(1)=208:WOBJ(1)=33:HOBJ(1)=460:GRAF_ANIM%(1)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(1)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(1)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
311 XOBJ(2)=176:YOBJ(2)=667:WOBJ(2)=1140:HOBJ(2)=20:GRAF_ANIM%(2)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(2)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(2)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
312 XOBJ(3)=175:YOBJ(3)=181:WOBJ(3)=1880:HOBJ(3)=27:GRAF_ANIM%(3)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(3)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(3)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
313 XOBJ(4)=306:YOBJ(4)=267:WOBJ(4)=481:HOBJ(4)=20:GRAF_ANIM%(4)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(4)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(4)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
314 XOBJ(5)=596:YOBJ(5)=287:WOBJ(5)=30:HOBJ(5)=220:GRAF_ANIM%(5)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(5)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(5)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
315 XOBJ(6)=307:YOBJ(6)=508:WOBJ(6)=490:HOBJ(6)=20:GRAF_ANIM%(6)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(6)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(6)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
316 XOBJ(7)=307:YOBJ(7)=428:WOBJ(7)=490:HOBJ(7)=20:GRAF_ANIM%(7)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(7)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(7)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
317 XOBJ(8)=176:YOBJ(8)=348:WOBJ(8)=260:HOBJ(8)=20:GRAF_ANIM%(8)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(8)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(8)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
318 XOBJ(9)=556:YOBJ(9)=588:WOBJ(9)=100:HOBJ(9)=20:GRAF_ANIM%(9)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(9)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(9)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
319 XOBJ(10)=656:YOBJ(10)=588:WOBJ(10)=280:HOBJ(10)=80:GRAF_ANIM%(10)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(10)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(10)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
320 XOBJ(11)=746:YOBJ(11)=348:WOBJ(11)=190:HOBJ(11)=20:GRAF_ANIM%(11)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(11)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(11)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
321 XOBJ(12)=916:YOBJ(12)=368:WOBJ(12)=20:HOBJ(12)=220:GRAF_ANIM%(12)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(12)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(12)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
322 XOBJ(13)=1056:YOBJ(13)=268:WOBJ(13)=80:HOBJ(13)=100:GRAF_ANIM%(13)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(13)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(13)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
323 XOBJ(14)=1056:YOBJ(14)=588:WOBJ(14)=60:HOBJ(14)=80:GRAF_ANIM%(14)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(14)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(14)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
324 XOBJ(15)=1256:YOBJ(15)=208:WOBJ(15)=20:HOBJ(15)=240:GRAF_ANIM%(15)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(15)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(15)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
325 XOBJ(16)=1056:YOBJ(16)=428:WOBJ(16)=200:HOBJ(16)=20:GRAF_ANIM%(16)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(16)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(16)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
326 XOBJ(17)=1056:YOBJ(17)=508:WOBJ(17)=360:HOBJ(17)=20:GRAF_ANIM%(17)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(17)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(17)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
327 XOBJ(18)=1396:YOBJ(18)=268:WOBJ(18)=20:HOBJ(18)=240:GRAF_ANIM%(18)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(18)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(18)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
328 XOBJ(19)=1416:YOBJ(19)=268:WOBJ(19)=120:HOBJ(19)=20:GRAF_ANIM%(19)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(19)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(19)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
329 XOBJ(20)=1316:YOBJ(20)=588:WOBJ(20)=320:HOBJ(20)=80:GRAF_ANIM%(20)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(20)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(20)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
330 XOBJ(21)=1536:YOBJ(21)=508:WOBJ(21)=400:HOBJ(21)=20:GRAF_ANIM%(21)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(21)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(21)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
331 XOBJ(22)=1636:YOBJ(22)=529:WOBJ(22)=64:HOBJ(22)=60:GRAF_ANIM%(22)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(22)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(22)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
332 XOBJ(23)=1536:YOBJ(23)=428:WOBJ(23)=340:HOBJ(23)=20:GRAF_ANIM%(23)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(23)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(23)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
333 XOBJ(24)=1876:YOBJ(24)=268:WOBJ(24)=44:HOBJ(24)=180:GRAF_ANIM%(24)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(24)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(24)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
334 XOBJ(25)=1806:YOBJ(25)=268:WOBJ(25)=70:HOBJ(25)=100:GRAF_ANIM%(25)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(25)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(25)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
335 XOBJ(26)=1916:YOBJ(26)=268:WOBJ(26)=140:HOBJ(26)=240:GRAF_ANIM%(26)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(26)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(26)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
336 XOBJ(27)=2056:YOBJ(27)=208:WOBJ(27)=24:HOBJ(27)=60:GRAF_ANIM%(27)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(27)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(27)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
337 XOBJ(28)=1536:YOBJ(28)=348:WOBJ(28)=140:HOBJ(28)=20:GRAF_ANIM%(28)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(28)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(28)=1:DELTA_OBJ=7:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
338 XOBJ(29)=1636:YOBJ(29)=208:WOBJ(29)=40:HOBJ(29)=140:GRAF_ANIM%(29)=1:SLEEP_OBJ%(0)=0:NAME_OBJ$(29)="grnd":INFO_OBJ%(0)=0:ULIK_OBJ%(0)=0:COLLISION_OBJ%(29)=1:DELTA_OBJ=5:TAKEN%(0)=0:HELL%(0)=0:LEFT_TO_PERSONA%(0)=0
339 XOBJ(30)=560:YOBJ(30)=386:WOBJ(30)=15:HOBJ(30)=44:GRAF_ANIM%(30)=2:SLEEP_OBJ%(30)=900:NAME_OBJ$(30)="gor":INFO_OBJ%(30)=1:ULIK_OBJ%(30)=0:COLLISION_OBJ%(30)=0:DELTA_OBJ=5:TAKEN%(30)=0:HELL%(0)=0:LEFT_TO_PERSONA%(30)=1
340 XOBJ(31)=360:YOBJ(31)=626:WOBJ(31)=15:HOBJ(31)=44:GRAF_ANIM%(31)=2:SLEEP_OBJ%(31)=900:NAME_OBJ$(31)="set":INFO_OBJ%(31)=1:ULIK_OBJ%(31)=0:COLLISION_OBJ%(31)=0:DELTA_OBJ=5:TAKEN%(31)=0:HELL%(0)=0:LEFT_TO_PERSONA%(31)=1
341 XOBJ(32)=1116:YOBJ(32)=604:WOBJ(32)=200:HOBJ(32)=64:GRAF_ANIM%(32)=10:SLEEP_OBJ%(32)=50:NAME_OBJ$(32)="lav":INFO_OBJ%(32)=0:ULIK_OBJ%(32)=0:COLLISION_OBJ%(32)=0:DELTA_OBJ=5:TAKEN%(32)=0:HELL%(32)=1:LEFT_TO_PERSONA%(32)=0
342 XOBJ(33)=1091:YOBJ(33)=226:WOBJ(33)=15:HOBJ(33)=44:GRAF_ANIM%(33)=2:SLEEP_OBJ%(33)=900:NAME_OBJ$(33)="tor":INFO_OBJ%(33)=1:ULIK_OBJ%(33)=0:COLLISION_OBJ%(33)=0:DELTA_OBJ=5:TAKEN%(33)=0:HELL%(0)=0:LEFT_TO_PERSONA%(33)=1
343 XOBJ(34)=1381:YOBJ(34)=546:WOBJ(34)=15:HOBJ(34)=44:GRAF_ANIM%(34)=2:SLEEP_OBJ%(34)=900:NAME_OBJ$(34)="ra":INFO_OBJ%(34)=1:ULIK_OBJ%(34)=0:COLLISION_OBJ%(34)=0:DELTA_OBJ=5:TAKEN%(34)=0:HELL%(0)=0:LEFT_TO_PERSONA%(34)=1
344 XOBJ(35)=618:YOBJ(35)=656:WOBJ(35)=12:HOBJ(35)=8:GRAF_ANIM%(35)=2:SLEEP_OBJ%(35)=500:NAME_OBJ$(35)="krov":INFO_OBJ%(35)=1:ULIK_OBJ%(35)=1:COLLISION_OBJ%(35)=0:DELTA_OBJ=5:TAKEN%(35)=0:HELL%(0)=0:LEFT_TO_PERSONA%(35)=1
345 XOBJ(36)=550:YOBJ(36)=496:WOBJ(36)=12:HOBJ(36)=8:GRAF_ANIM%(36)=2:SLEEP_OBJ%(36)=500:NAME_OBJ$(36)="pist":INFO_OBJ%(36)=1:ULIK_OBJ%(36)=1:COLLISION_OBJ%(36)=0:DELTA_OBJ=5:TAKEN%(36)=0:HELL%(0)=0:LEFT_TO_PERSONA%(36)=1
346 XOBJ(37)=660:YOBJ(37)=496:WOBJ(37)=12:HOBJ(37)=8:GRAF_ANIM%(37)=2:SLEEP_OBJ%(37)=500:NAME_OBJ$(37)="tk":INFO_OBJ%(37)=1:ULIK_OBJ%(37)=1:COLLISION_OBJ%(37)=0:DELTA_OBJ=5:TAKEN%(37)=0:HELL%(0)=0:LEFT_TO_PERSONA%(37)=1
347 XOBJ(38)=745:YOBJ(38)=256:WOBJ(38)=12:HOBJ(38)=8:GRAF_ANIM%(38)=2:SLEEP_OBJ%(38)=500:NAME_OBJ$(38)="zap":INFO_OBJ%(38)=1:ULIK_OBJ%(38)=1:COLLISION_OBJ%(38)=0:DELTA_OBJ=5:TAKEN%(38)=0:HELL%(0)=0:LEFT_TO_PERSONA%(38)=1
348 XOBJ(39)=1024:YOBJ(39)=656:WOBJ(39)=12:HOBJ(39)=8:GRAF_ANIM%(39)=2:SLEEP_OBJ%(39)=500:NAME_OBJ$(39)="krov":INFO_OBJ%(39)=1:ULIK_OBJ%(39)=1:COLLISION_OBJ%(39)=0:DELTA_OBJ=5:TAKEN%(39)=0:HELL%(0)=0:LEFT_TO_PERSONA%(39)=1
349 XOBJ(40)=1245:YOBJ(40)=496:WOBJ(40)=12:HOBJ(40)=8:GRAF_ANIM%(40)=2:SLEEP_OBJ%(40)=500:NAME_OBJ$(40)="sim":INFO_OBJ%(40)=1:ULIK_OBJ%(40)=1:COLLISION_OBJ%(40)=0:DELTA_OBJ=5:TAKEN%(40)=0:HELL%(0)=0:LEFT_TO_PERSONA%(40)=1
350 XOBJ(41)=1600:YOBJ(41)=576:WOBJ(41)=12:HOBJ(41)=8:GRAF_ANIM%(41)=2:SLEEP_OBJ%(41)=500:NAME_OBJ$(41)="tk":INFO_OBJ%(41)=1:ULIK_OBJ%(41)=1:COLLISION_OBJ%(41)=0:DELTA_OBJ=5:TAKEN%(41)=0:HELL%(0)=0:LEFT_TO_PERSONA%(41)=1
351 XOBJ(42)=1862:YOBJ(42)=496:WOBJ(42)=12:HOBJ(42)=8:GRAF_ANIM%(42)=2:SLEEP_OBJ%(42)=500:NAME_OBJ$(42)="zap":INFO_OBJ%(42)=1:ULIK_OBJ%(42)=1:COLLISION_OBJ%(42)=0:DELTA_OBJ=5:TAKEN%(42)=0:HELL%(0)=0:LEFT_TO_PERSONA%(42)=1
352 ALL_ULIKA%=8:XGOKEY=335:YGOKEY=110
400 REM "---------------TYPE - LIFT------------------------>>>>>"
401 LIFT%=13
402 DIM OS$(LIFT%): DIM XLIFT_ST(LIFT%): DIM YLIFT_ST(LIFT%): DIM XLIFT(LIFT%): DIM YLIFT(LIFT%): DIM XLIFT_POS(LIFT%): DIM YLIFT_POS(LIFT%): DIM WLIFT(LIFT%): DIM HLIFT(LIFT%): DIM LIFT_GRAF%(LIFT%): DIM S_LIFT%(LIFT%): DIM XLIFT_PRO%(LIFT%): DIM XLF%(LIFT%): DIM YLIFT_PRO%(LIFT%): DIM YLF%(LIFT%)
403 DIM LIFT_TIME%(LIFT%): DIM NAME_LIFT$(LIFT%): DIM STEP_LIFT(LIFT%): DIM DELAY_LIFT%(LIFT%): DIM ANIMA_LIFT%(LIFT%): DIM UGOL_LIFT(LIFT%): DIM LFZ(LIFT%): DIM ZNAK_LIFT(LIFT%)
404 OS$(0)="osy":XLIFT_ST(0)=431:YLIFT_ST(0)=588:XLIFT_POS(0)=431:YLIFT_POS(0)=641:WLIFT(0)=90:HLIFT(0)=20:LIFT_GRAF%(0)=2:LIFT_TIME%(0)=500:NAME_LIFT$(0)="lfg":STEP_LIFT(0)=360:DELTA_LIFT=7
405 OS$(1)="osy":XLIFT_ST(1)=216:YLIFT_ST(1)=428:XLIFT_POS(1)=216:YLIFT_POS(1)=561:WLIFT(1)=90:HLIFT(1)=20:LIFT_GRAF%(1)=2:LIFT_TIME%(1)=500:NAME_LIFT$(1)="lfg":STEP_LIFT(1)=360:DELTA_LIFT=7
406 OS$(2)="osy":XLIFT_ST(2)=436:YLIFT_ST(2)=348:XLIFT_POS(2)=436:YLIFT_POS(2)=401:WLIFT(2)=90:HLIFT(2)=20:LIFT_GRAF%(2)=2:LIFT_TIME%(2)=500:NAME_LIFT$(2)="lfg":STEP_LIFT(2)=360:DELTA_LIFT=7
407 OS$(3)="osy":XLIFT_ST(3)=216:YLIFT_ST(3)=268:XLIFT_POS(3)=216:YLIFT_POS(3)=321:WLIFT(3)=90:HLIFT(3)=20:LIFT_GRAF%(3)=2:LIFT_TIME%(3)=500:NAME_LIFT$(3)="lfg":STEP_LIFT(3)=360:DELTA_LIFT=7
408 OS$(4)="osy":XLIFT_ST(4)=656:YLIFT_ST(4)=348:XLIFT_POS(4)=656:YLIFT_POS(4)=401:WLIFT(4)=90:HLIFT(4)=20:LIFT_GRAF%(4)=2:LIFT_TIME%(4)=500:NAME_LIFT$(4)="lfg":STEP_LIFT(4)=360:DELTA_LIFT=7
409 OS$(5)="osy":XLIFT_ST(5)=796:YLIFT_ST(5)=428:XLIFT_POS(5)=796:YLIFT_POS(5)=561:WLIFT(5)=90:HLIFT(5)=20:LIFT_GRAF%(5)=2:LIFT_TIME%(5)=500:NAME_LIFT$(5)="lfg":STEP_LIFT(5)=360:DELTA_LIFT=7
410 OS$(6)="osy":XLIFT_ST(6)=936:YLIFT_ST(6)=348:XLIFT_POS(6)=936:YLIFT_POS(6)=641:WLIFT(6)=90:HLIFT(6)=20:LIFT_GRAF%(6)=2:LIFT_TIME%(6)=500:NAME_LIFT$(6)="lfg":STEP_LIFT(6)=720:DELTA_LIFT=7
411 OS$(7)="osy":XLIFT_ST(7)=1136:YLIFT_ST(7)=268:XLIFT_POS(7)=1136:YLIFT_POS(7)=401:WLIFT(7)=90:HLIFT(7)=20:LIFT_GRAF%(7)=2:LIFT_TIME%(7)=500:NAME_LIFT$(7)="lfg":STEP_LIFT(7)=360:DELTA_LIFT=7
412 OS$(8)="osy":XLIFT_ST(8)=1306:YLIFT_ST(8)=268:XLIFT_POS(8)=1306:YLIFT_POS(8)=481:WLIFT(8)=90:HLIFT(8)=20:LIFT_GRAF%(8)=2:LIFT_TIME%(8)=500:NAME_LIFT$(8)="lfg":STEP_LIFT(8)=360:DELTA_LIFT=7
413 OS$(9)="osy":XLIFT_ST(9)=1446:YLIFT_ST(9)=348:XLIFT_POS(9)=1446:YLIFT_POS(9)=561:WLIFT(9)=90:HLIFT(9)=20:LIFT_GRAF%(9)=2:LIFT_TIME%(9)=500:NAME_LIFT$(9)="lfg":STEP_LIFT(9)=360:DELTA_LIFT=7
414 OS$(10)="osy":XLIFT_ST(10)=1716:YLIFT_ST(10)=268:XLIFT_POS(10)=1716:YLIFT_POS(10)=401:WLIFT(10)=90:HLIFT(10)=20:LIFT_GRAF%(10)=2:LIFT_TIME%(10)=500:NAME_LIFT$(10)="lfg":STEP_LIFT(10)=360:DELTA_LIFT=7
415 OS$(11)="osx":XLIFT_ST(11)=966:YLIFT_ST(11)=268:XLIFT_POS(11)=786:YLIFT_POS(11)=268:WLIFT(11)=90:HLIFT(11)=20:LIFT_GRAF%(11)=2:LIFT_TIME%(11)=500:NAME_LIFT$(11)="lfv":STEP_LIFT(11)=360:DELTA_LIFT=7
416 OS$(12)="osx":XLIFT_ST(12)=1226:YLIFT_ST(12)=588:XLIFT_POS(12)=1116:YLIFT_POS(12)=588:WLIFT(12)=90:HLIFT(12)=20:LIFT_GRAF%(12)=2:LIFT_TIME%(12)=500:NAME_LIFT$(12)="lfv":STEP_LIFT(12)=360:DELTA_LIFT=6
500 REM "---------------TYPE - PLAYER---------------------->>>>>"
501 XMEN%=212:YMEN%=612:WMEN%=20:HMEN%=40:HEART=100:XSTAT=166:YSTAT=188
502 MENHOD%=6:TIME_MEN_HOD%=50
503 MENST%=2:TIME_MEN_ST%=900
504 MENOUT%=1:TIME_MEN_OUT%=0
550 REM "---------------brana------------------------------>>>>>"
551 BRONN%=5
552 DIM XBRONA(BRONN%): DIM YBRONA(BRONN%): DIM UG_BRONA(BRONN%)
553 UG_BRONA(0)=0:UG_BRONA(1)=1.26:UG_BRONA(2)=2.51:UG_BRONA(3)=3.77:UG_BRONA(4)=5.03:R_BRONA=400:GRAF_BRONT%=2:BRONN_SLEEP%=50:K_HEART%=1:ENERGY=100
600 REM "-----------LOAD OTHER DATA------------------------------"
601 FOR T%=1 TO MA%
602 ANIMA%(T%-1)=1
603 NEXT T%
604 FOR T%=0 TO MP%-1
605 ANIMP%(T%)=1
606 NEXT T%
607 FOR T%=0 TO OBJ%-1
608 ANIM_OBJ%(T%)=1
609 NEXT T%
610 FOR T%=0 TO LIFT%-1
611 ANIMA_LIFT%(T%)=1
612 NEXT T%
613 NAME_PERS$="sr1"
614 ANIMA_PERS%=1
615 ANIMA_HRT%=1
616 REM "-------------timer-------------------------------------"
617 GAME_TIMER%=1:MAP_TIMER%=672000:START_GAME%= MILLISECONDS (0):NAME_MIN$="":NAME_SEC$=""
1000 REM REM "---------------GAME ENGINE------------------->>>>>"
1100 CLS : DRAWGEL "fon",0-XMEN%+XSTAT,0-YMEN%+YSTAT:NAMEL$="1":NAMER$="1":NAMEF$="1":NAMEU$="1":HEARTHP=0
1200 REM "--------------MONSTER AKTIV-----------"
1210 FOR T%=0 TO MA%-1
1220 IF STATUSA%(T%)=-1 THEN  GOTO 1240
1230 IF STATUSA%(T%)=1 THEN  GOTO 1320
1240 IF XMA(T%)>=XPOSMA(T%) THEN ZNAK(T%)=-1
1250 IF XMA(T%)<=XSTMA(T%) THEN ZNAK(T%)=1
1270 IF  MILLISECONDS (0)-P_TIME%(T%)>P_TIMEANIM%(T%) THEN ANIMA%(T%)=ANIMA%(T%)+1:P_TIME%(T%)= MILLISECONDS (0)
1280 IF ANIMA%(T%)>P_NGRAFM%(T%) THEN ANIMA%(T%)=1
1290 IF ZNAK(T%)=1 THEN NAME$="rp"+NAMEA$(T%)+STR$(ANIMA%(T%))
1300 IF ZNAK(T%)=-1 THEN NAME$="lp"+NAMEA$(T%)+STR$(ANIMA%(T%))
1310 XMA(T%)=XMA(T%)+ZNAK(T%)*P_SPEEDM%(T%): DRAWGEL NAME$,XMA(T%)-XMEN%+XSTAT,YMA(T%)-YMEN%+YSTAT: GOTO 1400
1320 IF XMA(T%)>XMEN% THEN ZNAK(T%)=-1
1330 IF XMA(T%)<XMEN% THEN ZNAK(T%)=1
1350 IF  MILLISECONDS (0)-A_TIME%(T%)>A_TIMEANIM%(T%) THEN ANIMA%(T%)=ANIMA%(T%)+1:A_TIME%(T%)= MILLISECONDS (0)
1360 IF ANIMA%(T%)>A_NGRAFM%(T%) THEN ANIMA%(T%)=1
1370 IF ZNAK(T%)=1 THEN NAME$="ra"+NAMEA$(T%)+STR$(ANIMA%(T%))
1380 IF ZNAK(T%)=-1 THEN NAME$="la"+NAMEA$(T%)+STR$(ANIMA%(T%))
1390 XMA(T%)=XMA(T%)+ZNAK(T%)*A_SPEEDM%(T%): DRAWGEL NAME$,XMA(T%)-XMEN%+XSTAT,YMA(T%)-YMEN%+YSTAT
1400 IF STATUSA%(T%)=-1 AND (YMEN%+HMEN%)>YMA(T%) AND YMEN%<(YMA(T%)+HMA(T%)) AND XMEN%>(XSTMA(T%)-P_DELTAM%(T%)) AND XMEN%<(XPOSMA(T%)+P_DELTAM%(T%)) THEN STATUSA%(T%)=1
1530 IF STATUSA%(T%)=1 AND (YMEN%+HMEN%)<YMA(T%) OR YMEN%>(YMA(T%)+HMA(T%)) OR XMEN%<(XSTMA(T%)-A_DELTAM%(T%)) OR XMEN%>(XPOSMA(T%)+A_DELTAM%(T%)) THEN STATUSA%(T%)=-1
1620 IF STATUSA%(T%)=1 THEN U1=0:U2=0:U3=0:U4=0: GOTO 1640
1630 GOTO 1690
1640 IF XMEN%>XMA(T%) AND XMEN%<=(XMA(T%)+WMA(T%)) THEN U1=1
1650 IF XMA(T%)>=XMEN% AND XMA(T%)<(XMEN%+WMEN%) THEN U2=1
1660 IF YMEN%>YMA(T%) AND YMEN%<=(YMA(T%)+HMA(T%)) THEN U3=1
1670 IF YMA(T%)>=YMEN% AND YMA(T%)<(YMEN%+HMEN%) THEN U4=1
1680 IF U1+U2+U3+U4=2 THEN HEART=HEART-0.707*K_HEART%:HEARTHP=1
1690 NEXT T%
1700 REM "--------------MONSTER PASSIV----------"
1710 FOR T%=0 TO MP%-1
1720 IF STATUSP%(T%)=0 THEN  GOTO 1750
1730 IF STATUSP%(T%)=1 THEN  GOTO 1780
1740 IF STATUSP%(T%)=-1 THEN  GOTO 1810
1750 IF  MILLISECONDS (0)-MP_NTIME%(T%)>PTIME_N%(T%) THEN ANIMP%(T%)=ANIMP%(T%)+1:MP_NTIME%(T%)= MILLISECONDS (0)
1760 IF ANIMP%(T%)>PNGRAF_N%(T%) THEN ANIMP%(T%)=1
1770 NAME$="n"+NAMEP$(T%)+STR$(ANIMP%(T%)): GOTO 1840
1780 IF  MILLISECONDS (0)-MP_ATIME%(T%)>PTIME_A%(T%) THEN ANIMP%(T%)=ANIMP%(T%)+1:MP_ATIME%(T%)= MILLISECONDS (0)
1790 IF ANIMP%(T%)>PNGRAF_A%(T%) THEN ANIMP%(T%)=PNGRAF_A%(T%)
1800 NAME$="a"+NAMEP$(T%)+STR$(ANIMP%(T%)): GOTO 1840
1810 IF  MILLISECONDS (0)-MP_PTIME%(T%)>PTIME_P%(T%) THEN ANIMP%(T%)=ANIMP%(T%)+1:MP_PTIME%(T%)= MILLISECONDS (0)
1820 IF ANIMP%(T%)>PNGRAF_P%(T%) THEN ANIMP%(T%)=PNGRAF_P%(T%)
1830 NAME$="p"+NAMEP$(T%)+STR$(ANIMP%(T%)): GOTO 1840
1840 DRAWGEL NAME$,XMP(T%)-XMEN%+XSTAT-25,YMP(T%)-YMEN%+YSTAT:ZONA%(T%)=0: IF XMEN%>(XMP(T%)-DELTA_MP%(T%)) AND XMEN%<(XMP(T%)+WMP(T%)+DELTA_MP%(T%)) AND (YMEN%+HMEN%)>YMP(T%) AND YMEN%<(YMP(T%)+HMP(T%)) THEN ZONA%(T%)=1
1930 IF STATUSP%(T%)=0 AND ZONA%(T%)=1 THEN STATUSP%(T%)=1:TIMES_MP%(T%)= MILLISECONDS (0):ANIMP%(T%)=1
1940 IF STATUSP%(T%)=1 AND  MILLISECONDS (0)-TIMES_MP%(T%)>2000 THEN STATUSP%(T%)=-1:TIMES_MP%(T%)= MILLISECONDS (0):ANIMP%(T%)=1
1950 IF STATUSP%(T%)=-1 AND  MILLISECONDS (0)-TIMES_MP%(T%)>2000 AND ZONA%(T%)=0 THEN STATUSP%(T%)=0:ANIMP%(T%)=1
1960 IF STATUSP%(T%)=-1 AND  MILLISECONDS (0)-TIMES_MP%(T%)>2000 AND ZONA%(T%)=1 THEN STATUSP%(T%)=1:TIMES_MP%(T%)= MILLISECONDS (0):ANIMP%(T%)=1
2020 IF STATUSP%(T%)=1 THEN U1=0:U2=0:U3=0:U4=0: GOTO 2040
2030 GOTO 2090
2040 IF XMEN%>XMP(T%) AND XMEN%<=(XMP(T%)+WMP(T%)) THEN U1=1
2050 IF XMP(T%)>=XMEN% AND XMP(T%)<(XMEN%+WMEN%) THEN U2=1
2060 IF YMEN%>YMP(T%) AND YMEN%<=(YMP(T%)+HMP(T%)) THEN U3=1
2070 IF YMP(T%)>=YMEN% AND YMP(T%)<(YMEN%+HMEN%) THEN U4=1
2080 IF U1+U2+U3+U4=2 THEN HEART=HEART-0.707*K_HEART%:HEARTHP=1
2090 NEXT T%
2091 DRAWGEL NAME_PERS$,XSTAT-10,YSTAT-9
2100 REM "--------------object------------------"
2110 OBJ_DOWN%=0:OBJ_UP%=0:OBJ_LEFT%=0:OBJ_RIGHT%=0:SUMM_STATUS_OBJ=0:SUMM_STATUS_I=0
2120 FOR T%=0 TO OBJ%-1
2122 U1=0:U2=0:U3=0:U4=0
2160 IF XMEN%>XOBJ(T%) AND XMEN%<=(XOBJ(T%)+WOBJ(T%)) THEN U1=1
2170 IF XOBJ(T%)>=XMEN% AND XOBJ(T%)<(XMEN%+WMEN%) THEN U2=1
2180 IF YMEN%>YOBJ(T%) AND YMEN%<=(YOBJ(T%)+HOBJ(T%)) THEN U3=1
2190 IF YOBJ(T%)>=YMEN% AND YOBJ(T%)<(YMEN%+HMEN%) THEN U4=1
2200 S_OBJ%(T%)=0: IF U1+U2+U3+U4=2 THEN S_OBJ%(T%)=1: IF COLLISION_OBJ%(T%)=1 THEN  GOTO 2220
2201 GOTO 2260
2220 IF YOBJ(T%)-YMEN%<=HMEN% AND YOBJ(T%)-YMEN%>HMEN%-DELTA_OBJ AND S_OBJ%(T%)=1 THEN OBJ_DOWN%=1: GOTO 2260
2230 IF YMEN%-YOBJ(T%)<=HOBJ(T%) AND YMEN%-YOBJ(T%)>HOBJ(T%)-DELTA_OBJ AND S_OBJ%(T%)=1 THEN OBJ_UP%=1: GOTO 2260
2240 IF S_OBJ%(T%)=1 AND XMEN%-XOBJ(T%)>0 AND XOBJ(T%)+WOBJ(T%)-XMEN%>0 THEN OBJ_LEFT%=1: GOTO 2260
2250 IF S_OBJ%(T%)=1 AND XMEN%+WMEN%-XOBJ(T%)>0 AND XOBJ(T%)+WOBJ(T%)-XMEN%-WMEN%>0 THEN OBJ_RIGHT%=1
2260 IF S_OBJ%(T%)=1 AND HELL%(T%)=1 THEN HEART=HEART-0.707*K_HEART%:HEARTHP=1
2261 IF STATUS_INFO%(T%)=0 AND ULIK_OBJ%(T%)=1 AND BU%(T%)=1 AND TAKEN%(T%)=0 THEN TAKEN%(T%)=1:XOBJ(T%)=999:YOBJ(T%)=999:ULIKA=ULIKA+1:GOKEY=1: GOTO 2441
2330 IF  MILLISECONDS (0)-TIME_OBJ%(T%)>SLEEP_OBJ%(T%) THEN ANIM_OBJ%(T%)=ANIM_OBJ%(T%)+1:TIME_OBJ%(T%)= MILLISECONDS (0)
2340 IF ANIM_OBJ%(T%)>GRAF_ANIM%(T%) THEN ANIM_OBJ%(T%)=1
2350 LEFT_TO%(T%)=0: IF XMEN%-XOBJ(T%)<0 THEN LEFT_TO%(T%)=1
2360 NAME$=NAME_OBJ$(T%)+STR$(ANIM_OBJ%(T%)): IF LEFT_TO_PERSONA%(T%)=1 AND LEFT_TO%(T%)=1 THEN NAME$="left"+NAME_OBJ$(T%)+STR$(ANIM_OBJ%(T%))
2370 DRAWGEL NAME$,XOBJ(T%)-XMEN%+XSTAT,YOBJ(T%)-YMEN%+YSTAT
2380 IF ( POINTX(0)>70 AND  POINTX(0)<125 AND  POINTY(0)>309 AND  POINTY(0)<369 OR  FIRE (0)) AND  MILLISECONDS (0)-STATUS_TIME%>SLEEP_STATUS% AND S_OBJ%(T%)=1 AND INFO_OBJ%(T%)=1 AND STATUS_INFO%(T%)=0 THEN STATUS_INFO%(T%)=1:STATUS_TIME%= MILLISECONDS (0):NAMEF$="2": GOTO 2441
2390 IF STATUS_INFO%(T%)=0 AND INFO_OBJ%(T%)=1 AND S_OBJ%(T%)=1 THEN SUMM_STATUS_OBJ=SUMM_STATUS_OBJ+1: GOTO 2410
2400 GOTO 2441
2410 IF  MILLISECONDS (0)-TIME_INFO%>SLEEP_INFO% THEN ANIM_INFO%=ANIM_INFO%+1:TIME_INFO%= MILLISECONDS (0)
2420 IF ANIM_INFO%>GRAFANIM_INFO% THEN ANIM_INFO%=1
2430 YINFO=YOBJ(T%)-HINFO-1:XINFO=XOBJ(T%)+((WOBJ(T%)-WINFO)/2):NAME$=INFO_ICON$+STR$(ANIM_INFO%): DRAWGEL NAME$,XINFO-XMEN%+XSTAT,YINFO-YMEN%+YSTAT
2441 IF STATUS_INFO%(T%)=1 THEN SUMM_STATUS_I=SUMM_STATUS_I+1:OBJ_LEFT%=1:OBJ_RIGHT%=1
2442 NEXT T%
2600 REM "------------lift process--------------"
2610 FOR T%=0 TO LIFT%-1
2620 IF  MILLISECONDS (0)-DELAY_LIFT%(T%)>LIFT_TIME%(T%) THEN ANIMA_LIFT%(T%)=ANIMA_LIFT%(T%)+1:DELAY_LIFT%(T%)= MILLISECONDS (0)
2630 IF ANIMA_LIFT%(T%)>LIFT_GRAF%(T%) THEN ANIMA_LIFT%(T%)=1
2640 NAME$=NAME_LIFT$(T%)+STR$(ANIMA_LIFT%(T%)):XLIFT_PRO%(T%)=XLIFT(T%):YLIFT_PRO%(T%)=YLIFT(T%)
2650 IF XLIFT(T%)<=XLIFT_POS(T%) THEN ZNAK_LIFT(T%)=1
2660 IF XLIFT(T%)>=XLIFT_ST(T%) THEN ZNAK_LIFT(T%)=-1
2670 IF OS$(T%)="osx" THEN RAD_LIFT=1+ABS((XLIFT_POS(T%)-XLIFT_ST(T%))/2):OX_LIFT=(XLIFT_ST(T%)+XLIFT_POS(T%))/2:STEPS=6.28/STEP_LIFT(T%): GOTO 2690
2680 IF OS$(T%)="osy" THEN RAD_LIFT=1+ABS((YLIFT_POS(T%)-YLIFT_ST(T%))/2):OY_LIFT=(YLIFT_POS(T%)+YLIFT_ST(T%))/2:STEPS=6.28/STEP_LIFT(T%): GOTO 2710
2690 UGOL_LIFT(T%)=UGOL_LIFT(T%)+ZNAK_LIFT(T%)*STEPS:XLIFT(T%)=OX_LIFT+RAD_LIFT*COS(UGOL_LIFT(T%)):K_LIFT=(YLIFT_POS(T%)-YLIFT_ST(T%))/(XLIFT_POS(T%)-XLIFT_ST(T%))
2700 B_LIFT=YLIFT_ST(T%)-K_LIFT*XLIFT_ST(T%):YLIFT(T%)=K_LIFT*XLIFT(T%)+B_LIFT: IF YLIFT_ST(T%)-YLIFT_POS(T%)=0 THEN YLIFT(T%)=YLIFT_ST(T%)
2701 GOTO 2730
2710 UGOL_LIFT(T%)=UGOL_LIFT(T%)+ZNAK_LIFT(T%)*STEPS:YLIFT(T%)=OY_LIFT+RAD_LIFT*SIN(UGOL_LIFT(T%)):K_LIFT=(YLIFT_POS(T%)-YLIFT_ST(T%))/(XLIFT_POS(T%)-XLIFT_ST(T%))
2720 B_LIFT=YLIFT_ST(T%)-K_LIFT*XLIFT_ST(T%):XLIFT(T%)=(YLIFT(T%)-B_LIFT)/K_LIFT: IF XLIFT_ST(T%)-XLIFT_POS(T%)=0 THEN XLIFT(T%)=XLIFT_ST(T%): GOTO 2730
2730 DRAWGEL NAME$,XLIFT(T%)-XMEN%+XSTAT-22,YLIFT(T%)-YMEN%+YSTAT-22:U1=0:U2=0:U3=0:U4=0
2830 IF XMEN%>XLIFT(T%) AND XMEN%<=(XLIFT(T%)+WLIFT(T%)) THEN U1=1
2840 IF XLIFT(T%)>=XMEN% AND XLIFT(T%)<(XMEN%+WMEN%) THEN U2=1
2850 IF YMEN%>YLIFT(T%) AND YMEN%<=(YLIFT(T%)+HLIFT(T%)) THEN U3=1
2860 IF YLIFT(T%)>=YMEN% AND YLIFT(T%)<(YMEN%+HMEN%) THEN U4=1
2870 S_LIFT%(T%)=0: IF U1+U2+U3+U4=2 THEN S_LIFT%(T%)=1
2880 IF YLIFT(T%)-YMEN%>HMEN%-DELTA_LIFT AND S_LIFT%(T%)=1 THEN YLF%(T%)=YLIFT(T%):YMEN%=YMEN%+ZNAK_LIFT(T%)*(YLIFT_PRO%(T%)-YLF%(T%)):XLF%(T%)=XLIFT(T%):XMEN%=XMEN%+ZNAK_LIFT(T%)*ABS(XLIFT_PRO%(T%)-XLF%(T%)):OBJ_DOWN%=1
2890 NEXT T%
2891 REM "------------men upravlenie------------"
2892 IF ( POINTX(0)>70 AND  POINTX(0)<125 AND  POINTY(0)>309 AND  POINTY(0)<369 OR  FIRE (0)) AND  MILLISECONDS (0)-STATUS_TIME%>SLEEP_STATUS% AND SUMM_STATUS_I=0 AND SUMM_STATUS_OBJ=0 AND BRONA=0 AND ENERGY>33 THEN BRONA=1:K_HEART%=0:TIME_BRONA%= MILLISECONDS (0):ENERGY=ENERGY-33:NAMEF$="2"
2910 IF ( POINTX(0)>3 AND  POINTX(0)<60 AND  POINTY(0)>313 AND  POINTY(0)<377 OR  LEFT (0)) AND OBJ_LEFT%=0 AND OBJ_DOWN%=1 THEN LEFT_RIGHT_MEN%=-1:XMEN%=XMEN%-3:NAMEL$="2": GOTO 2942
2911 IF ( POINTX(0)>290 AND  POINTX(0)<349 AND  POINTY(0)>313 AND  POINTY(0)<377 OR  RIGHT (0)) AND OBJ_RIGHT%=0 AND OBJ_DOWN%=1 THEN LEFT_RIGHT_MEN%=1:XMEN%=XMEN%+3:NAMER$="2": GOTO 2945
2920 IF ( POINTX(0)>3 AND  POINTX(0)<60 AND  POINTY(0)>313 AND  POINTY(0)<377 OR  LEFT (0)) AND OBJ_LEFT%=0 AND OBJ_DOWN%=0 THEN LEFT_RIGHT_MEN%=-1:XMEN%=XMEN%-3:NAMEL$="2": GOTO 2948
2921 IF ( POINTX(0)>290 AND  POINTX(0)<349 AND  POINTY(0)>313 AND  POINTY(0)<377 OR  RIGHT (0)) AND OBJ_RIGHT%=0 AND OBJ_DOWN%=0 THEN LEFT_RIGHT_MEN%=1:XMEN%=XMEN%+3:NAMER$="2": GOTO 2948
2922 IF STATUS_UP=1 OR OBJ_DOWN%=0 THEN  GOTO 2948
2923 IF  POINTX(0)>335 AND  POINTX(0)<352 AND  POINTY(0)>110 AND  POINTY(0)<145 AND GOKEY=0 THEN GOKEY=1
2930 IF ( POINTX(0)>227 AND  POINTX(0)<280 AND  POINTY(0)>309 AND  POINTY(0)<369 OR  UP (0)) AND OBJ_UP%=0 AND STATUS_UP=0 AND OBJ_DOWN%=1 THEN STATUS_UP=1:YMEN_FIX%=YMEN%:NAMEU$="2": GOTO 2948
2931 REM "------------men status----------------"
2932 IF  MILLISECONDS (0)-PERS_TIME%>TIME_MEN_ST% THEN ANIMA_PERS%=ANIMA_PERS%+1:PERS_TIME%= MILLISECONDS (0)
2933 IF ANIMA_PERS%>MENST% THEN ANIMA_PERS%=1
2934 NAME_PERS$="sr"+STR$(ANIMA_PERS%): IF LEFT_RIGHT_MEN%=-1 THEN NAME_PERS$="sl"+STR$(ANIMA_PERS%)
2935 GOTO 3032
2942 IF  MILLISECONDS (0)-PERS_TIME%>TIME_MEN_HOD% THEN ANIMA_PERS%=ANIMA_PERS%+1:PERS_TIME%= MILLISECONDS (0)
2943 IF ANIMA_PERS%>MENHOD% THEN ANIMA_PERS%=1
2944 NAME_PERS$="l"+STR$(ANIMA_PERS%): GOTO 3032
2945 IF  MILLISECONDS (0)-PERS_TIME%>TIME_MEN_HOD% THEN ANIMA_PERS%=ANIMA_PERS%+1:PERS_TIME%= MILLISECONDS (0)
2946 IF ANIMA_PERS%>MENHOD% THEN ANIMA_PERS%=1
2947 NAME_PERS$="r"+STR$(ANIMA_PERS%): GOTO 3032
2948 IF  MILLISECONDS (0)-PERS_TIME%>TIME_MEN_OUT% THEN ANIMA_PERS%=ANIMA_PERS%+1:PERS_TIME%= MILLISECONDS (0)
2949 IF ANIMA_PERS%>MENOUT% THEN ANIMA_PERS%=1
2950 NAME_PERS$="upr"+STR$(ANIMA_PERS%): IF LEFT_RIGHT_MEN%=-1 THEN NAME_PERS$="upl"+STR$(ANIMA_PERS%)
2951 GOTO 3032
3031 REM "-----------------brona----------------------"
3032 IF BRONA=1 AND R_BRONA>50 THEN R_BRONA=R_BRONA-5
3033 IF BRONA=1 AND  MILLISECONDS (0)-TIME_BRONA%>10000 THEN BRONA=0:K_HEART%=1
3034 IF BRONA=0 AND R_BRONA<400 THEN R_BRONA=R_BRONA+5
3035 FOR T%=0 TO BRONN%-1
3036 UG_BRONA(T%)=UG_BRONA(T%)+0.02:XBRONA(T%)=-30+XSTAT+R_BRONA*COS(UG_BRONA(T%)):YBRONA(T%)=-17+YSTAT+R_BRONA*SIN(UG_BRONA(T%)):NAME$="shar"+STR$(T%+1): DRAWGEL NAME$,XBRONA(T%),YBRONA(T%)
3037 NEXT T%
3038 IF ENERGY<100 THEN ENERGY=ENERGY+0.01
3039 IF  MILLISECONDS (0)-BRONN_TIME%>BRONN_SLEEP% AND BRONA=1 THEN ANIMA_BRONT%=ANIMA_BRONT%+1:BRONN_TIME%= MILLISECONDS (0): GOTO 3041
3040 GOTO 3051
3041 IF ANIMA_BRONT%>GRAF_BRONT% THEN ANIMA_BRONT%=1
3042 NAME$="brona"+STR$(ANIMA_BRONT%): DRAWGEL NAME$,XSTAT-43,YSTAT-34
3050 REM "-----------------------fon------------------"
3051 IF HEARTHP=1 AND K_HEART%=1 THEN NAME_HRT$="hearthp"+STR$(ANIMA_HRT%): DRAWGEL NAME_HRT$,0,0: GOTO 3053
3052 GOTO 3055
3053 IF  MILLISECONDS (0)-HRT%>50 THEN ANIMA_HRT%=ANIMA_HRT%+1:HRT%= MILLISECONDS (0)
3054 IF ANIMA_HRT%>2 THEN ANIMA_HRT%=1
3055 DRAWGEL "play",0,0: DRAWGEL "loadh",32,7: DRAWGEL "loade",32,31
3060 REM "----------------objects info----------------"
3065 FOR T%=0 TO OBJ%-1
3070 IF STATUS_INFO%(T%)=1 THEN NAME$="txt"+NAME_OBJ$(T%): DRAWGEL NAME$,XTXTINF,YTXTINF
3075 IF ( POINTX(0)>70 AND  POINTX(0)<125 AND  POINTY(0)>309 AND  POINTY(0)<369 OR  FIRE (0)) AND  MILLISECONDS (0)-STATUS_TIME%>SLEEP_STATUS% AND STATUS_INFO%(T%)=1 THEN STATUS_INFO%(T%)=0:BU%(T%)=1:STATUS_TIME%= MILLISECONDS (0):NAMEF$="2"
3076 NEXT T%
3077 REM "------------lupa - inf-------------------------"
3078 IF GOKEY=1 AND XGOKEY>267 THEN XGOKEY=XGOKEY-2.236
3079 IF XGOKEY<=267 AND GOKEY=1 THEN GOKEY=0:SEARCHING%= MILLISECONDS (0):XGOKEY=267
3080 IF  MILLISECONDS (0)-SEARCHING%>3141 AND XGOKEY=267 AND GOKEY=0 THEN GOKEY=-1
3081 IF GOKEY=-1 AND XGOKEY<335 THEN XGOKEY=XGOKEY+2.236
3082 IF GOKEY=-1 AND XGOKEY>=335 THEN XGOKEY=335:GOKEY=0
3083 N_ULIKA%=ULIKA:TXT_KEY$=STR$(N_ULIKA%)+" / "+STR$(ALL_ULIKA%): DRAWGEL "gokey",XGOKEY,YGOKEY: SETCOLOR 255,255,255: DRAWSTRING TXT_KEY$,XGOKEY+39,YGOKEY+8
3084 REM "----------w  h  screen-------------------------"
3085 IF WSW=1 THEN  DRAWGEL "wscreenw",352,0
3086 IF HSH=1 THEN  DRAWGEL "hscreenh",0,416
3087 REM "-------------sensor gel-------------------------------"
3088 NAMEL$="lsens"+NAMEL$:NAMER$="rsens"+NAMER$:NAMEF$="fsens"+NAMEF$:NAMEU$="usens"+NAMEU$: DRAWGEL NAMEL$,3,313: DRAWGEL NAMER$,285,313: DRAWGEL NAMEF$,65,309: DRAWGEL NAMEU$,227,309
3089 REM "----------timer-------------------------"
3090 IF GAME_TIMER%=0 THEN  GOTO 3097
3091 IF NAME_MIN$="00" AND NAME_SEC$="00" THEN  GOTO 3120
3092 GAME_GAME%=MAP_TIMER%-( MILLISECONDS (0)-START_GAME%):MINUTA%=GAME_GAME%/60000:SEKUNDA%=(GAME_GAME%-(MINUTA%*60000))/1000
3093 NAME_MIN$=STR$(MINUTA%): IF MINUTA%<10 THEN NAME_MIN$="0"+STR$(MINUTA%)
3094 NAME_SEC$=STR$(SEKUNDA%): IF SEKUNDA%<10 THEN NAME_SEC$="0"+STR$(SEKUNDA%)
3095 DRAWGEL "timers",0,0: DRAWSTRING NAME_MIN$,157,390: DRAWSTRING NAME_SEC$,179,390
3096 REM "------------------------------------------"
3097 WHEART=262*(HEART/100): IF WHEART<=1 THEN  GOTO 3120
3098 REPAINT: DRAWGEL "lh",0,0: GELGRAB "loadh",0,0,WHEART,13: COLORALPHAGEL "loadh",0,255,255,255: DRAWGEL "le",0,0:WENERGY=262*(ENERGY/100): GELGRAB "loade",0,0,WENERGY,13: COLORALPHAGEL "loade",0,255,255,255
3099 REM "----------------gravitations up/down-------"
3100 IF STATUS_UP=1 AND YMEN_FIX%-YMEN%<60 AND OBJ_UP%=0 THEN YMEN%=YMEN%-6
3105 IF STATUS_UP=1 AND YMEN_FIX%-YMEN%>60 OR OBJ_UP%=1 THEN STATUS_UP=0:OBJ_DOWN%=0
3110 IF OBJ_DOWN%=0 THEN YMEN%=YMEN%+3
3115 GOTO 1100
3120 GELGRAB "deadend",0,0,352,416: DRAWGEL "endblood",0,0: GELGRAB "death",0,0,352,416:ASS=-1
3125 FOR T%=0 TO 255 STEP 4
3130 ASS=ASS+1:ALPH%=T%: ALPHAGEL "death",ALPH%
3135 IF ASS=2 AND GGG=0 THEN ASS=0:GGG=1
3140 IF ASS=2 AND GGG=1 THEN ASS=0:GGG=0
3145 IF ASS=1 AND GGG2=1 THEN GGG2=0: GOTO 3155
3150 IF ASS=1 AND GGG2=0 THEN GGG2=1: GOTO 3155
3155 XDEAD=-1+2*GGG:YDEAD=-1+2*GGG2: CLS : DRAWGEL "deadend",XDEAD,YDEAD: DRAWGEL "death",0,0: DRAWGEL "camera",0,0: REPAINT
3160 NEXT T%
3165 SLEEP 5500: END 
